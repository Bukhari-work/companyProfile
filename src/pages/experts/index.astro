---
import Main from "@/layouts/Main.astro";
import { getSinglePage } from "@/lib/contentParser.astro";
import { getEntry, type CollectionEntry } from "astro:content";

import SideBar from "@/components/SideBar.astro";
import PeopleDeck from "@/components/PeopleDeck.astro";
import AuthorCard from "@/components/blocks/AuthorCard.astro";

const PEOPLE_FOLDER = "people";

// Fetch all entries from the 'people' collection
const people: CollectionEntry<"people">[] = await getSinglePage(PEOPLE_FOLDER);

// Filter the people to show only those with role = "The Team"
const experts = people.filter((person) => person.data.role === "Experts");
const seniorExperts = experts.filter(
  (person) => person.data.responsibility === "Senior Expert",
);
const seniorResearchers = experts.filter(
  (person) => person.data.responsibility === "Senior Researcher",
);

// Attributes for the Main layout
const content = { title: "About Us - Experts" };
---

<Main content={content} makara>
  <section class="mx-auto grid max-w-7xl grid-cols-7 gap-6 p-2 pb-24">
    <SideBar className="col-span-7 lg:col-span-1" />
    <article
      class="prose dark:prose-invert col-span-7 min-w-full text-justify font-light lg:col-span-5"
    >
      <h1
        class="font-lexend text-primary mt-0 mb-2 w-fit scroll-mt-24 text-6xl font-semibold lg:mt-8"
      >
        THE EXPERTS
      </h1>
      <div class="w-full">
        <div>
          <h2 class="text-3xl">Senior Experts</h2>
          <div
            class="not-prose grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3"
          >
            {seniorExperts.map((person) => <AuthorCard data={person} />)}
          </div>
          <h2 class="text-3xl">Senior Researchers</h2>
          <div
            class="not-prose mb-24 grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3"
          >
            {seniorResearchers.map((person) => <AuthorCard data={person} />)}
          </div>
        </div>
      </div>
    </article>
  </section>
</Main>
